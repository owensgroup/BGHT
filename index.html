<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BGHT: &lt;a href=&quot;https://owensgroup.github.io/BGHT/&quot;&gt;BGHT: Better GPU Hash Tables&lt;/a&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BGHT
   </div>
   <div id="projectbrief">High-performance static GPU hash tables.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a href="https://owensgroup.github.io/BGHT/">BGHT: Better GPU Hash Tables</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> | <a href="https://owensgroup.github.io/BGHT/"><b>Documentation</b></a> | <a href="https://github.com/owensgroup/BGHT/tree/main/test"><b>Examples/Tests</b></a> | <a href="https://github.com/owensgroup/BGHT/tree/main/benchmarks"><b>Benchmarks</b></a> | <a href="https://github.com/owensgroup/BGHT/blob/main/results.md"><b>Results</b></a> | |-----------&mdash;|-------------------&mdash;|----------------&mdash;|----------------&mdash;|</p>
<p>BGHT is a collection of high-performance static GPU hash tables. BGHT contains hash tables that use three different probing schemes 1) bucketed cuckoo, 2) power-of-two, 3) iceberg hashing. Our bucketed static cuckoo hash table is the state-of-art static hash table. For more information, please check our paper:</p>
<p><a href="https://arxiv.org/abs/2108.07232"><b>Better GPU Hash Tables</b></a><br  />
 <em><a href="https://maawad.github.io/">Muhammad A. Awad</a>, <a href="https://scholar.google.com/citations?user=Z4_ZfiEAAAAJ&amp;hl=en">Saman Ashkiani</a>, <a href="https://web.cs.ucdavis.edu/~porumbes/">Serban D. Porumbescu</a>, <a href="https://people.cs.rutgers.edu/~farach/">Mart√≠n Farach-Colton</a>, and <a href="https://www.ece.ucdavis.edu/~jowens/">John D. Owens</a></em></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Key features</h1>
<ul>
<li>State-of-the-art static GPU hash tables</li>
<li>Device and host side APIs</li>
<li>Support for different types of keys and values</li>
<li>Standard-like APIs</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
How to use</h1>
<p>BGHT is a header-only library. To use the library, you can add it as a submodule or use <a href="https://github.com/cpm-cmake/CPM.cmake">CMake Package Manager (CPM)</a> to fetch the library into your CMake-based project (<a href="https://github.com/owensgroup/BGHT/tree/main/test/cpm">complete example</a>). </p><div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.8 FATAL_ERROR)</div>
<div class="line">CPMAddPackage(</div>
<div class="line">  NAME bght</div>
<div class="line">  GITHUB_REPOSITORY owensgroup/BGHT</div>
<div class="line">  GIT_TAG main</div>
<div class="line">  OPTIONS</div>
<div class="line">     &quot;build_tests OFF&quot;</div>
<div class="line">     &quot;build_benchmarks OFF&quot;</div>
<div class="line">)</div>
<div class="line">target_link_libraries(my_library PRIVATE bght)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md3"></a>
APIs</h2>
<p>All the data structures follow the C++ standard hash map (<code>std::unordered_map</code>) APIs closely. An example APIs for BCHT is shown below: </p><div class="fragment"><div class="line"> {c++}</div>
<div class="line">template &lt;class Key,</div>
<div class="line">          class T,</div>
<div class="line">          class Hash = bght::universal_hash&lt;Key&gt;,</div>
<div class="line">          class KeyEqual = bght::equal_to&lt;Key&gt;,</div>
<div class="line">          cuda::thread_scope Scope = cuda::thread_scope_device,</div>
<div class="line">          class Allocator = bght::cuda_allocator&lt;char&gt;,</div>
<div class="line">          int B = 16&gt; class bcht;</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md4"></a>
Member functions</h3>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">// Constructor</div>
<div class="line">bcht(std::size_t capacity,</div>
<div class="line">     Key sentinel_key,</div>
<div class="line">     T sentinel_value,</div>
<div class="line">     Allocator const&amp; allocator = Allocator{});</div>
<div class="line">// Host-side APIs</div>
<div class="line">template &lt;typename InputIt&gt;</div>
<div class="line">  bool insert(InputIt first, InputIt last, cudaStream_t stream = 0);</div>
<div class="line">template &lt;typename InputIt, typename OutputIt&gt;</div>
<div class="line">  void find(InputIt first, InputIt last, OutputIt output_begin, cudaStream_t stream = 0);</div>
<div class="line">// Device-side APIs</div>
<div class="line">template &lt;typename tile_type&gt;</div>
<div class="line">__device__ bool insert(value_type const&amp; pair, tile_type const&amp; tile);</div>
<div class="line">template &lt;typename tile_type&gt;</div>
<div class="line">__device__ mapped_type find(key_type const&amp; key, tile_type const&amp; tile);</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md5"></a>
Member types</h2>
<div class="fragment"><div class="line">Member type                     Definition</div>
<div class="line">key_type                        Key</div>
<div class="line">mapped_type                     T</div>
<div class="line">value_type                      bght::pair&lt;Key, T&gt;</div>
<div class="line">allocator_type                  Allocator</div>
<div class="line">bucket_size                     Bucket size for device-side APIs cooperative groups tile construction</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md6"></a>
Example</h3>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">// Example using host-side APIs</div>
<div class="line">#include &lt;bcht.hpp&gt;</div>
<div class="line">int main(){</div>
<div class="line">  using key_type = uint32_t;</div>
<div class="line">  using value_type = uint32_t;</div>
<div class="line">  using pair_type = bght::pair&lt;key_type, value_type&gt;;</div>
<div class="line">  std::size_t capacity = 128; std::size_t num_keys = 64;</div>
<div class="line">  key_type invalid_key = 0; value_type invalid_value = 0; // sentinel key and value</div>
<div class="line"> </div>
<div class="line">  bght::bcht&lt;key_type, value_type&gt; table(capacity, invalid_key, invalid_value); //ctor</div>
<div class="line"> </div>
<div class="line">  pair_type* pairs; // input pairs</div>
<div class="line">  // ... allocate pairs</div>
<div class="line"> </div>
<div class="line">  bool success = table.insert(pairs, pairs + num_keys);</div>
<div class="line">  assert(success);</div>
<div class="line"> </div>
<div class="line">  key_type* queries;  // query keys</div>
<div class="line">  value_type* results; // query result</div>
<div class="line">  // ... allocate queries and results</div>
<div class="line">  table.find(queries, queries + num_keys, results);</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line"> {c++}</div>
<div class="line">// Example using device-side APIs</div>
<div class="line">template&lt;class HashMap&gt;</div>
<div class="line">__global__ void kernel(HashMap table){</div>
<div class="line">  // construct tile</div>
<div class="line">  auto block = cooperative_groups::this_thread_block();</div>
<div class="line">  auto tile = cooperative_groups::tiled_partition&lt;HashMap::bucket_size&gt;(block);</div>
<div class="line">  pair_type pair{...};</div>
<div class="line">  table.insert(pair, tile);</div>
<div class="line">  pair_type query{..};</div>
<div class="line">  query.second = table.find(query.first, tile);</div>
<div class="line">}</div>
<div class="line">int main(){</div>
<div class="line">  // Call the hash table constructor on the CPU</div>
<div class="line">  bght::bcht&lt;key_type, value_type&gt; table(...);</div>
<div class="line">  // Pass the hash table to a GPU kernel</div>
<div class="line">  kernel&lt;&lt;&lt;...&gt;&gt;&gt;(table);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Requirements and limitations</h1>
<p>Please create an issue if you face challenges with any of the following limitations and requirements. </p>
<h2><a class="anchor" id="autotoc_md8"></a>
Requirements</h2>
<ul>
<li>C++17/CUDA C++17</li>
<li>NVIDIA Volta GPU or later microarchitectures</li>
<li>CMake 3.8 or later</li>
<li>CUDA 11.5 or later</li>
</ul>
<h3><a class="anchor" id="autotoc_md9"></a>
Using Docker</h3>
<p>We provide a docker image that include the software requirements (except for CUDA drivers). To build the docker image, run: </p><div class="fragment"><div class="line">source docker/build</div>
</div><!-- fragment --><p> To start the container, run: </p><div class="fragment"><div class="line">source docker/run</div>
</div><!-- fragment --><p> After starting the container, you can build and execute BGHT code without any additional requirements.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
limitations</h2>
<ul>
<li>Currently hash tables based on cuckoo hashing do not support concurrent insertion and queries. IHT and P2BHT support concurrent insertions and queries.</li>
<li>Keys must be unique</li>
<li>Construction of the data structures offered <em>may</em> fail. In these scenarios, reconstructing the table using a larger capacity or a lower load factor should be considered. Our paper offers recommended hash table load factors (for uniformly distributed unsigned keys) to achieve at least a 99% success rate (<a href="https://arxiv.org/abs/2108.07232">See Fig. 2</a>). For example, BCHT will offer a 100% success rate for up to 0.991 load factor. Please create an issue if you encounter any problems with different key distributions.</li>
</ul>
<h1><a class="anchor" id="autotoc_md11"></a>
Reproducing the arXiv paper results</h1>
<p>To reproduce the results, follow the following steps. You can also view our results here. If you find any mismatch (either faster or slower) between the results offered in the repository or the paper, please create an issue, and we will investigate the performance changes.</p>
<h1><a class="anchor" id="autotoc_md12"></a>
Benchmarks</h1>
<p>Please check our <a href="https://arxiv.org/abs/2108.07232">paper</a> for comprehensive analysis and benchmarks. Also, see the following steps to reproduce the results.</p>
<p>An additional comparison of our BCHT to <code>cucCollection</code>'s <code>cuco::static_map</code> is shown below. The comparison is between our BCHT with B = 16 (default configuration) and <code>cuco::static_map</code>. Input keys (50 million pairs) are uniformly distributed unsigned keys. The benchmarking was performed on an NVIDIA Titan V GPU (higher is better):</p>
<p><img src="/figs/arxiv/NVIDIA-TITAN-V/bcht_vs_cuco.svg" alt="" style="pointer-events: none;" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md13"></a>
Questions and bug report</h1>
<p>Please create an issue. We will welcome any contributions that improve the usability and quality of our repository.</p>
<h1><a class="anchor" id="autotoc_md14"></a>
Bibtex</h1>
<div class="fragment"><div class="line">@InProceedings{   Awad:2023:AAI,</div>
<div class="line">  title         = {Analyzing and Implementing {GPU} Hash Tables},</div>
<div class="line">  author        = {Muhammad A. Awad and Saman Ashkiani and Serban D.</div>
<div class="line">                  Porumbescu and Mart{\&#39;{i}}n Farach-Colton and John D.</div>
<div class="line">                  Owens},</div>
<div class="line">  booktitle     = &quot;SIAM Symposium on Algorithmic Principles of Computer</div>
<div class="line">                  Systems&quot;,</div>
<div class="line">  series        = {APOCS23},</div>
<div class="line">  year          = 2023,</div>
<div class="line">  month         = jan,</div>
<div class="line">  pages         = {33--50},</div>
<div class="line">  code          = {https://github.com/owensgroup/BGHT},</div>
<div class="line">  doi           = {10.1137/1.9781611977578.ch3},</div>
<div class="line">  url           = {https://escholarship.org/uc/item/6cb1q6rz}</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md15"></a>
Acknowledgments</h1>
<p>The structure and organization of the repository were inspired by <a href="https://github.com/nviDIA/cuCollections/">NVIDIA's cuCollection</a> and <a href="https://github.com/owensgroup/RXMesh">RXMesh</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
